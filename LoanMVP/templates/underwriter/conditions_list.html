{% extends "layouts/base.html" %}
{% block title %}Underwriter ‚Ä¢ Conditions Center{% endblock %}

{% block content %}
<style>
  :root {
    --bg:#0f0f11; --panel:#15161a; --line:#2a2e36;
    --text:#e6e6e6; --muted:#a5a7ad; --accent:#7ab8ff;
    --hover:#1f2328; --glow:0 0 12px rgba(122,184,255,.35);
  }

  body { background:var(--bg); color:var(--text); }
  .card {
    background: var(--panel);
    border: 1px solid var(--line);
    border-radius: 14px;
    padding: 1.2rem;
    box-shadow: var(--glow);
    margin-bottom: 1rem;
  }

  table { width:100%; border-collapse:collapse; }
  th,td { padding:.8rem .6rem; border-top:1px solid var(--line); }
  th { color:#cfe0f5; text-align:left; font-weight:600; font-size:.9rem; }

  .btn {
    display:inline-flex; align-items:center; gap:.4rem;
    background:linear-gradient(180deg,#1b1d22,#15161a);
    color:var(--text); border:1px solid var(--line);
    border-radius:10px; padding:.45rem .8rem; font-size:.85rem;
    transition:all .2s ease;
  }
  .btn:hover { color:#cfe8ff; border-color:var(--accent); box-shadow:var(--glow); }

  .btn-blue { background:linear-gradient(180deg,#1f2a36,#15161a); border-color:#2d4c6e; }
  .btn-green { background:linear-gradient(180deg,#1f3d31,#162821); border-color:#2f6b4f; }
  .btn-yellow { background:linear-gradient(180deg,#3a361f,#282316); border-color:#6b622f; }
  .btn-red { background:linear-gradient(180deg,#3d1f1f,#281616); border-color:#6b2f2f; }

  .muted { color:var(--muted); font-size:.9rem; }
</style>

<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2><i class="fa-solid fa-list-check"></i> Conditions Center</h2>
    <a href="{{ url_for('underwriter.dashboard') }}" class="btn">‚Üê Back to Dashboard</a>
  </div>

  <div class="card">
    <div class="muted mb-3">
      Review and manage underwriting conditions for active loans.  
      Click ‚ÄúManage Conditions‚Äù to open the detailed view and add or update items.
    </div>

    <table>
      <thead>
        <tr>
          <th>Loan ID</th>
          <th>Borrower</th>
          <th>Loan Type</th>
          <th>Status</th>
          <th>Conditions</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for item in loans_with_conditions %}
        {% set loan = item.loan %}
        <tr>
          <td>#{{ loan.id }}</td>
          <td>{{ loan.borrower_profile.full_name if loan.borrower_profile else '‚Äî' }}</td>
          <td>{{ loan.loan_type or 'N/A' }}</td>
          <td>{{ loan.status|capitalize }}</td>
          <td>{{ item.condition_count }}</td>
          <td style="white-space:nowrap;">
            <a href="{{ url_for('underwriter.conditions', loan_id=loan.id) }}" class="btn btn-yellow">
              ‚öñ Manage Conditions
            </a>
            <a href="{{ url_for('underwriter.review_loan', loan_id=loan.id) }}" class="btn btn-blue">
              üîç Review Loan
            </a>
            <a href="{{ url_for('underwriter.ai_risk_details', loan_id=loan.id) }}" class="btn btn-green">
              üß† Risk
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
