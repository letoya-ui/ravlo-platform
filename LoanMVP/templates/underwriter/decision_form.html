<!-- =========================================================
     1Ô∏è‚É£ decision_form.html
     ========================================================= -->
{% extends "layouts/base.html" %}
{% block title %}Loan Decision{% endblock %}
{% block content %}
<style>
  :root{
    --bg:#0f0f11;--panel:#15161a;--line:#2a2e36;
    --text:#e6e6e6;--muted:#a5a7ad;--accent:#7ab8ff;
    --glow:0 0 16px rgba(122,184,255,.4);
  }
  body{background:var(--bg);color:var(--text);}
  .card{background:var(--panel);border:1px solid var(--line);
        border-radius:14px;padding:1.2rem;box-shadow:var(--glow);}
  select,textarea,input{
    background:#0f0f11;border:1px solid var(--line);color:var(--text);
    border-radius:10px;padding:.55rem;width:100%;
  }
  .btn{
    background:#1a1d23;border:1px solid var(--line);border-radius:10px;
    color:var(--text);padding:.6rem 1.1rem;
  }
  .btn:hover{border-color:var(--accent);box-shadow:var(--glow);}
</style>

<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2><i class="fa-solid fa-scale-balanced"></i> Loan Decision</h2>
    <a href="{{ url_for('underwriter.dashboard') }}" class="btn btn-outline-light btn-sm">‚Üê Back</a>
  </div>

  <div class="card">
    <form method="POST">
      <div class="mb-3">
        <label for="loan_id">Loan ID</label>
        <input type="text" name="loan_id" id="loan_id" value="{{ loan.id if loan else '' }}" readonly>
      </div>
      <div class="mb-3">
        <label for="decision">Decision</label>
        <select name="decision" id="decision" required>
          <option value="">Select Decision</option>
          <option value="approved">‚úÖ Approve</option>
          <option value="declined">‚ùå Decline</option>
          <option value="suspended">‚è∏Ô∏è Suspend</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="notes">Notes / Conditions</label>
        <textarea name="notes" id="notes" rows="4"
          placeholder="Add reasoning, risk notes, or approval conditions..."></textarea>
      </div>
      <div class="mb-3">
        <button type="submit" class="btn btn-primary">Submit Decision</button>
        <button type="button" class="btn" onclick="generateAI()">ü§ñ AI Suggestion</button>
      </div>
      <div id="aiSuggestion" class="mt-3 text-muted small" style="white-space:pre-wrap;"></div>
    </form>
  </div>
</div>

<script>
  function generateAI(){
    const noteBox = document.getElementById('aiSuggestion');
    noteBox.innerText = "AI is reviewing risk factors...";
    setTimeout(()=>{
      noteBox.innerText = "AI Suggestion:\nBased on income stability and DTI < 40%, this loan is low risk.\nRecommend: APPROVE with condition - verify latest paystub.";
    },1000);
  }
</script>
{% endblock %}