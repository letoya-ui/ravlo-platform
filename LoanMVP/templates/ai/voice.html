{% extends "layouts/base.html" %}
{% block title %}AI Voice Interaction{% endblock %}
{% block content %}

<main style="margin-left:260px; padding:2rem; background:#0f0f11; color:#e6e6e6; min-height:100vh;">
  <link rel="stylesheet" href="https://unpkg.com/lucide-static@latest/font/lucide.css">

  <style>
    .voice-wrap{max-width:900px;margin:auto;background:#15161a;border:1px solid #282b31;border-radius:16px;padding:2rem;box-shadow:0 0 18px rgba(122,184,255,0.25);}
    h1{color:#7ab8ff;margin-bottom:.6rem;}
    p.muted{color:#a5a7ad;margin-bottom:1.5rem;font-size:.9rem;}
    .mic-section{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;background:#0f0f11;border:1px solid #2b2f36;border-radius:14px;}
    .mic-btn{
      width:90px;height:90px;border-radius:50%;display:flex;align-items:center;justify-content:center;
      background:radial-gradient(circle at 30% 30%,#2a4a62,#1b2a38);border:2px solid #2a4a62;color:#cfe8ff;font-size:2rem;
      box-shadow:0 0 20px rgba(122,184,255,0.35);cursor:pointer;transition:all .3s ease;
    }
    .mic-btn.active{box-shadow:0 0 40px rgba(122,184,255,0.7);background:radial-gradient(circle at 30% 30%,#3d6fa2,#2a4a62);}
    .waveform{display:flex;align-items:flex-end;justify-content:center;height:60px;margin-top:1.2rem;gap:4px;}
    .bar{width:6px;background:#7ab8ff;border-radius:2px;animation:wave 1s infinite ease-in-out;}
    @keyframes wave{
      0%,100%{height:10px;opacity:0.5;}
      50%{height:50px;opacity:1;}
    }
    .bar:nth-child(2){animation-delay:.1s;}
    .bar:nth-child(3){animation-delay:.2s;}
    .bar:nth-child(4){animation-delay:.3s;}
    .bar:nth-child(5){animation-delay:.4s;}
    .bar:nth-child(6){animation-delay:.5s;}
    .bar:nth-child(7){animation-delay:.6s;}
    .output-card{margin-top:2rem;background:#18222b;border:1px solid #2b2f36;border-radius:14px;padding:1.2rem;box-shadow:0 0 12px rgba(122,184,255,0.2);}
    .btn{display:inline-flex;align-items:center;gap:.4rem;margin-top:1rem;background:linear-gradient(180deg,#2a4a62,#1b2a38);border:1px solid #2a4a62;color:#cfe8ff;border-radius:10px;padding:.7rem 1.2rem;text-decoration:none;cursor:pointer;}
    .btn:hover{box-shadow:0 0 10px rgba(122,184,255,0.3);}
  </style>

  <div class="voice-wrap">
    <h1><i class="lucide lucide-mic"></i> AI Voice Interaction</h1>
    <p class="muted">Speak directly to your AI system â€” record voice commands, transcribe borrower discussions, or let the AI respond audibly.</p>

    <!-- Microphone Control -->
    <div class="mic-section">
      <button id="micBtn" class="mic-btn" onclick="toggleMic()">
        <i class="lucide lucide-mic"></i>
      </button>
      <div class="waveform" id="waveform">
        <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
        <div class="bar"></div><div class="bar"></div><div class="bar"></div>
      </div>
      <div id="statusText" style="margin-top:1rem;color:#cfe8ff;">Tap the mic to start listening...</div>
    </div>

    <!-- AI Output -->
    <div class="output-card">
      <h3 style="color:#7ab8ff;display:flex;align-items:center;gap:.5rem;"><i class="lucide lucide-message-circle"></i> AI Response</h3>
      <p id="voiceOutput">No input detected yet.</p>
      <button class="btn" onclick="playAudio()"><i class="lucide lucide-volume-2"></i> Play AI Audio</button>
    </div>
  </div>

  <script>
    let listening=false;

    function toggleMic(){
      const mic=document.getElementById('micBtn');
      const status=document.getElementById('statusText');
      const waveform=document.getElementById('waveform');
      listening=!listening;

      if(listening){
        mic.classList.add('active');
        status.textContent='ðŸŽ™ Listening... speak now!';
        waveform.style.opacity='1';
        // Simulate AI recognition delay
        setTimeout(()=> {
          document.getElementById('voiceOutput').textContent='AI: Detected command â€” "Generate borrower readiness report."';
          status.textContent='âœ… Voice captured and processed.';
        }, 3000);
      }else{
        mic.classList.remove('active');
        status.textContent='Tap the mic to start listening...';
        waveform.style.opacity='0.5';
      }
    }

    function playAudio(){
      const audio=new Audio('https://cdn.pixabay.com/download/audio/2022/10/11/audio_20f0d1531d.mp3?filename=soft-digital-voice-12214.mp3');
      audio.play();
    }
  </script>
</main>
{% endblock %}
