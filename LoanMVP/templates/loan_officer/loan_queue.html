{% extends "layouts/base.html" %}
{% block title %}Loan Queue{% endblock %}
{% block content %}
<style>
  :root {
    --bg:#0f0f11;
    --panel:#15161a;
    --line:#2a2e36;
    --text:#e6e6e6;
    --muted:#a5a7ad;
    --accent:#7ab8ff;
  }

  body {
    background: var(--bg);
    color: var(--text);
  }

  .card {
    background: var(--panel);
    border: 1px solid var(--line);
    border-radius: 14px;
    padding: 1rem;
    box-shadow: 0 0 14px rgba(0,0,0,0.3);
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th, td {
    padding: .7rem .8rem;
    border-top: 1px solid var(--line);
    color: var(--text);
    vertical-align: middle;
  }

  th {
    background: #1f2127;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  tr:hover {
    background: #1a1c22;
    transition: 0.2s ease;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: .5rem;
    padding: .55rem .9rem;
    border-radius: 10px;
    border: 1px solid var(--line);
    color: var(--text);
    text-decoration: none;
    background: #1a1d23;
    font-size: .9rem;
  }

  .btn:hover {
    background: var(--accent);
    color: #000;
    border-color: var(--accent);
    transition: 0.2s ease-in-out;
  }

  .badge {
    border-radius: 8px;
    padding: .35rem .6rem;
    font-size: .8rem;
  }

  .badge-success {
    background: #198754;
  }

  .badge-danger {
    background: #dc3545;
  }

  .badge-secondary {
    background: #6c757d;
  }
</style>

<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0 text-accent">üìÇ Loan Queue</h2>
    <a href="{{ url_for('loan_officer.new_loan') }}" class="btn btn-accent">‚ûï New Loan</a>
  </div>

  {% if loans %}
  <div class="card shadow-sm">
    <div class="table-responsive">
      <table class="table table-dark table-hover align-middle">
        <thead class="table-secondary text-dark">
          <tr>
            <th>ID</th>
            <th>Borrower</th>
            <th>Loan Type</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for loan in loans %}
          <tr>
            <td>#{{ loan.id }}</td>
            <td>{{ loan.borrower_profile.full_name if loan.borrower_profile else '‚Äî' }}</td>
            <td>{{ loan.loan_type or '‚Äî' }}</td>
            <td>${{ "%.2f"|format(loan.amount or 0) }}</td>
            <td>
              <span class="badge badge-{% if loan.status == 'approved' %}success{% elif loan.status == 'declined' %}danger{% else %}secondary{% endif %}">
                {{ loan.status|capitalize }}
              </span>
            </td>
            <td>{{ loan.created_at.strftime("%Y-%m-%d") if loan.created_at else '‚Äî' }}</td>
            <td>
              <a href="{{ url_for('loan_officer.view_loan', loan_id=loan.id) }}" class="btn btn-sm btn-outline-light">
                üëÅ View
              </a>
              <a href="{{ url_for('loan_officer.edit_loan', loan_id=loan.id) }}" class="btn btn-sm btn-outline-light">
                ‚úèÔ∏è Edit
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% else %}
  <div class="alert alert-secondary bg-dark text-light border-0 mt-4">
    No loans currently in the queue.
  </div>
  {% endif %}
</div>
{% endblock %}
